{"ast":null,"code":"import { dispatch } from \"d3-dispatch\";\nimport { dragDisable, dragEnable } from \"d3-drag\";\nimport { interpolateZoom } from \"d3-interpolate\";\nimport { event, customEvent, select, mouse, touch } from \"d3-selection\";\nimport { interrupt } from \"d3-transition\";\nimport constant from \"./constant\";\nimport ZoomEvent from \"./event\";\nimport { Transform, identity } from \"./transform\";\nimport noevent, { nopropagation } from \"./noevent\"; // Ignore right-click, since that should open the context menu.\n\nfunction defaultFilter() {\n  return !event.button;\n}\n\nfunction defaultExtent() {\n  var e = this,\n      w,\n      h;\n\n  if (e instanceof SVGElement) {\n    e = e.ownerSVGElement || e;\n    w = e.width.baseVal.value;\n    h = e.height.baseVal.value;\n  } else {\n    w = e.clientWidth;\n    h = e.clientHeight;\n  }\n\n  return [[0, 0], [w, h]];\n}\n\nfunction defaultTransform() {\n  return this.__zoom || identity;\n}\n\nfunction defaultWheelDelta() {\n  return -event.deltaY * (event.deltaMode ? 120 : 1) / 500;\n}\n\nfunction defaultTouchable() {\n  return \"ontouchstart\" in this;\n}\n\nfunction defaultConstrain(transform, extent, translateExtent) {\n  var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],\n      dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],\n      dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],\n      dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];\n  return transform.translate(dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1), dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1));\n}\n\nexport default function () {\n  var filter = defaultFilter,\n      extent = defaultExtent,\n      constrain = defaultConstrain,\n      wheelDelta = defaultWheelDelta,\n      touchable = defaultTouchable,\n      scaleExtent = [0, Infinity],\n      translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],\n      duration = 250,\n      interpolate = interpolateZoom,\n      gestures = [],\n      listeners = dispatch(\"start\", \"zoom\", \"end\"),\n      touchstarting,\n      touchending,\n      touchDelay = 500,\n      wheelDelay = 150,\n      clickDistance2 = 0;\n\n  function zoom(selection) {\n    selection.property(\"__zoom\", defaultTransform).on(\"wheel.zoom\", wheeled).on(\"mousedown.zoom\", mousedowned).on(\"dblclick.zoom\", dblclicked).filter(touchable).on(\"touchstart.zoom\", touchstarted).on(\"touchmove.zoom\", touchmoved).on(\"touchend.zoom touchcancel.zoom\", touchended).style(\"touch-action\", \"none\").style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  zoom.transform = function (collection, transform) {\n    var selection = collection.selection ? collection.selection() : collection;\n    selection.property(\"__zoom\", defaultTransform);\n\n    if (collection !== selection) {\n      schedule(collection, transform);\n    } else {\n      selection.interrupt().each(function () {\n        gesture(this, arguments).start().zoom(null, typeof transform === \"function\" ? transform.apply(this, arguments) : transform).end();\n      });\n    }\n  };\n\n  zoom.scaleBy = function (selection, k) {\n    zoom.scaleTo(selection, function () {\n      var k0 = this.__zoom.k,\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return k0 * k1;\n    });\n  };\n\n  zoom.scaleTo = function (selection, k) {\n    zoom.transform(selection, function () {\n      var e = extent.apply(this, arguments),\n          t0 = this.__zoom,\n          p0 = centroid(e),\n          p1 = t0.invert(p0),\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);\n    });\n  };\n\n  zoom.translateBy = function (selection, x, y) {\n    zoom.transform(selection, function () {\n      return constrain(this.__zoom.translate(typeof x === \"function\" ? x.apply(this, arguments) : x, typeof y === \"function\" ? y.apply(this, arguments) : y), extent.apply(this, arguments), translateExtent);\n    });\n  };\n\n  zoom.translateTo = function (selection, x, y) {\n    zoom.transform(selection, function () {\n      var e = extent.apply(this, arguments),\n          t = this.__zoom,\n          p = centroid(e);\n      return constrain(identity.translate(p[0], p[1]).scale(t.k).translate(typeof x === \"function\" ? -x.apply(this, arguments) : -x, typeof y === \"function\" ? -y.apply(this, arguments) : -y), e, translateExtent);\n    });\n  };\n\n  function scale(transform, k) {\n    k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));\n    return k === transform.k ? transform : new Transform(k, transform.x, transform.y);\n  }\n\n  function translate(transform, p0, p1) {\n    var x = p0[0] - p1[0] * transform.k,\n        y = p0[1] - p1[1] * transform.k;\n    return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);\n  }\n\n  function centroid(extent) {\n    return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];\n  }\n\n  function schedule(transition, transform, center) {\n    transition.on(\"start.zoom\", function () {\n      gesture(this, arguments).start();\n    }).on(\"interrupt.zoom end.zoom\", function () {\n      gesture(this, arguments).end();\n    }).tween(\"zoom\", function () {\n      var that = this,\n          args = arguments,\n          g = gesture(that, args),\n          e = extent.apply(that, args),\n          p = center || centroid(e),\n          w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),\n          a = that.__zoom,\n          b = typeof transform === \"function\" ? transform.apply(that, args) : transform,\n          i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));\n      return function (t) {\n        if (t === 1) t = b; // Avoid rounding error on end.\n        else {\n            var l = i(t),\n                k = w / l[2];\n            t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k);\n          }\n        g.zoom(null, t);\n      };\n    });\n  }\n\n  function gesture(that, args) {\n    for (var i = 0, n = gestures.length, g; i < n; ++i) {\n      if ((g = gestures[i]).that === that) {\n        return g;\n      }\n    }\n\n    return new Gesture(that, args);\n  }\n\n  function Gesture(that, args) {\n    this.that = that;\n    this.args = args;\n    this.index = -1;\n    this.active = 0;\n    this.extent = extent.apply(that, args);\n  }\n\n  Gesture.prototype = {\n    start: function () {\n      if (++this.active === 1) {\n        this.index = gestures.push(this) - 1;\n        this.emit(\"start\");\n      }\n\n      return this;\n    },\n    zoom: function (key, transform) {\n      if (this.mouse && key !== \"mouse\") this.mouse[1] = transform.invert(this.mouse[0]);\n      if (this.touch0 && key !== \"touch\") this.touch0[1] = transform.invert(this.touch0[0]);\n      if (this.touch1 && key !== \"touch\") this.touch1[1] = transform.invert(this.touch1[0]);\n      this.that.__zoom = transform;\n      this.emit(\"zoom\");\n      return this;\n    },\n    end: function () {\n      if (--this.active === 0) {\n        gestures.splice(this.index, 1);\n        this.index = -1;\n        this.emit(\"end\");\n      }\n\n      return this;\n    },\n    emit: function (type) {\n      customEvent(new ZoomEvent(zoom, type, this.that.__zoom), listeners.apply, listeners, [type, this.that, this.args]);\n    }\n  };\n\n  function wheeled() {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, arguments),\n        t = this.__zoom,\n        k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),\n        p = mouse(this); // If the mouse is in the same location as before, reuse it.\n    // If there were recent wheel events, reset the wheel idle timeout.\n\n    if (g.wheel) {\n      if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {\n        g.mouse[1] = t.invert(g.mouse[0] = p);\n      }\n\n      clearTimeout(g.wheel);\n    } // If this wheel event won’t trigger a transform change, ignore it.\n    else if (t.k === k) return; // Otherwise, capture the mouse point and location at the start.\n      else {\n          g.mouse = [p, t.invert(p)];\n          interrupt(this);\n          g.start();\n        }\n\n    noevent();\n    g.wheel = setTimeout(wheelidled, wheelDelay);\n    g.zoom(\"mouse\", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));\n\n    function wheelidled() {\n      g.wheel = null;\n      g.end();\n    }\n  }\n\n  function mousedowned() {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var g = gesture(this, arguments),\n        v = select(event.view).on(\"mousemove.zoom\", mousemoved, true).on(\"mouseup.zoom\", mouseupped, true),\n        p = mouse(this),\n        x0 = event.clientX,\n        y0 = event.clientY;\n    dragDisable(event.view);\n    nopropagation();\n    g.mouse = [p, this.__zoom.invert(p)];\n    interrupt(this);\n    g.start();\n\n    function mousemoved() {\n      noevent();\n\n      if (!g.moved) {\n        var dx = event.clientX - x0,\n            dy = event.clientY - y0;\n        g.moved = dx * dx + dy * dy > clickDistance2;\n      }\n\n      g.zoom(\"mouse\", constrain(translate(g.that.__zoom, g.mouse[0] = mouse(g.that), g.mouse[1]), g.extent, translateExtent));\n    }\n\n    function mouseupped() {\n      v.on(\"mousemove.zoom mouseup.zoom\", null);\n      dragEnable(event.view, g.moved);\n      noevent();\n      g.end();\n    }\n  }\n\n  function dblclicked() {\n    if (!filter.apply(this, arguments)) return;\n    var t0 = this.__zoom,\n        p0 = mouse(this),\n        p1 = t0.invert(p0),\n        k1 = t0.k * (event.shiftKey ? 0.5 : 2),\n        t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, arguments), translateExtent);\n    noevent();\n    if (duration > 0) select(this).transition().duration(duration).call(schedule, t1, p0);else select(this).call(zoom.transform, t1);\n  }\n\n  function touchstarted() {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, arguments),\n        touches = event.changedTouches,\n        started,\n        n = touches.length,\n        i,\n        t,\n        p;\n    nopropagation();\n\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = touch(this, touches, t.identifier);\n      p = [p, this.__zoom.invert(p), t.identifier];\n      if (!g.touch0) g.touch0 = p, started = true;else if (!g.touch1) g.touch1 = p;\n    } // If this is a dbltap, reroute to the (optional) dblclick.zoom handler.\n\n\n    if (touchstarting) {\n      touchstarting = clearTimeout(touchstarting);\n\n      if (!g.touch1) {\n        g.end();\n        p = select(this).on(\"dblclick.zoom\");\n        if (p) p.apply(this, arguments);\n        return;\n      }\n    }\n\n    if (started) {\n      touchstarting = setTimeout(function () {\n        touchstarting = null;\n      }, touchDelay);\n      interrupt(this);\n      g.start();\n    }\n  }\n\n  function touchmoved() {\n    var g = gesture(this, arguments),\n        touches = event.changedTouches,\n        n = touches.length,\n        i,\n        t,\n        p,\n        l;\n    noevent();\n    if (touchstarting) touchstarting = clearTimeout(touchstarting);\n\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = touch(this, touches, t.identifier);\n      if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;\n    }\n\n    t = g.that.__zoom;\n\n    if (g.touch1) {\n      var p0 = g.touch0[0],\n          l0 = g.touch0[1],\n          p1 = g.touch1[0],\n          l1 = g.touch1[1],\n          dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,\n          dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;\n      t = scale(t, Math.sqrt(dp / dl));\n      p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];\n      l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];\n    } else if (g.touch0) p = g.touch0[0], l = g.touch0[1];else return;\n\n    g.zoom(\"touch\", constrain(translate(t, p, l), g.extent, translateExtent));\n  }\n\n  function touchended() {\n    var g = gesture(this, arguments),\n        touches = event.changedTouches,\n        n = touches.length,\n        i,\n        t;\n    nopropagation();\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function () {\n      touchending = null;\n    }, touchDelay);\n\n    for (i = 0; i < n; ++i) {\n      t = touches[i];\n      if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;\n    }\n\n    if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;\n    if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);else g.end();\n  }\n\n  zoom.wheelDelta = function (_) {\n    return arguments.length ? (wheelDelta = typeof _ === \"function\" ? _ : constant(+_), zoom) : wheelDelta;\n  };\n\n  zoom.filter = function (_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), zoom) : filter;\n  };\n\n  zoom.touchable = function (_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), zoom) : touchable;\n  };\n\n  zoom.extent = function (_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;\n  };\n\n  zoom.scaleExtent = function (_) {\n    return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];\n  };\n\n  zoom.translateExtent = function (_) {\n    return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];\n  };\n\n  zoom.constrain = function (_) {\n    return arguments.length ? (constrain = _, zoom) : constrain;\n  };\n\n  zoom.duration = function (_) {\n    return arguments.length ? (duration = +_, zoom) : duration;\n  };\n\n  zoom.interpolate = function (_) {\n    return arguments.length ? (interpolate = _, zoom) : interpolate;\n  };\n\n  zoom.on = function () {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? zoom : value;\n  };\n\n  zoom.clickDistance = function (_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);\n  };\n\n  return zoom;\n}","map":{"version":3,"sources":["/Users/laurenho/Desktop/teamtech2020/node_modules/react-sunburst-d3-v4/node_modules/d3-zoom/src/zoom.js"],"names":["dispatch","dragDisable","dragEnable","interpolateZoom","event","customEvent","select","mouse","touch","interrupt","constant","ZoomEvent","Transform","identity","noevent","nopropagation","defaultFilter","button","defaultExtent","e","w","h","SVGElement","ownerSVGElement","width","baseVal","value","height","clientWidth","clientHeight","defaultTransform","__zoom","defaultWheelDelta","deltaY","deltaMode","defaultTouchable","defaultConstrain","transform","extent","translateExtent","dx0","invertX","dx1","dy0","invertY","dy1","translate","Math","min","max","filter","constrain","wheelDelta","touchable","scaleExtent","Infinity","duration","interpolate","gestures","listeners","touchstarting","touchending","touchDelay","wheelDelay","clickDistance2","zoom","selection","property","on","wheeled","mousedowned","dblclicked","touchstarted","touchmoved","touchended","style","collection","schedule","each","gesture","arguments","start","apply","end","scaleBy","k","scaleTo","k0","k1","t0","p0","centroid","p1","invert","scale","translateBy","x","y","translateTo","t","p","transition","center","tween","that","args","g","a","b","i","concat","l","n","length","Gesture","index","active","prototype","push","emit","key","touch0","touch1","splice","type","pow","wheel","clearTimeout","setTimeout","wheelidled","v","view","mousemoved","mouseupped","x0","clientX","y0","clientY","moved","dx","dy","shiftKey","t1","call","touches","changedTouches","started","identifier","l0","l1","dp","dl","sqrt","_","clickDistance"],"mappings":"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","sourcesContent":["import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolateZoom} from \"d3-interpolate\";\nimport {event, customEvent, select, mouse, touch} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant\";\nimport ZoomEvent from \"./event\";\nimport {Transform, identity} from \"./transform\";\nimport noevent, {nopropagation} from \"./noevent\";\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter() {\n  return !event.button;\n}\n\nfunction defaultExtent() {\n  var e = this, w, h;\n  if (e instanceof SVGElement) {\n    e = e.ownerSVGElement || e;\n    w = e.width.baseVal.value;\n    h = e.height.baseVal.value;\n  } else {\n    w = e.clientWidth;\n    h = e.clientHeight;\n  }\n  return [[0, 0], [w, h]];\n}\n\nfunction defaultTransform() {\n  return this.__zoom || identity;\n}\n\nfunction defaultWheelDelta() {\n  return -event.deltaY * (event.deltaMode ? 120 : 1) / 500;\n}\n\nfunction defaultTouchable() {\n  return \"ontouchstart\" in this;\n}\n\nfunction defaultConstrain(transform, extent, translateExtent) {\n  var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],\n      dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],\n      dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],\n      dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];\n  return transform.translate(\n    dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1),\n    dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1)\n  );\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      extent = defaultExtent,\n      constrain = defaultConstrain,\n      wheelDelta = defaultWheelDelta,\n      touchable = defaultTouchable,\n      scaleExtent = [0, Infinity],\n      translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],\n      duration = 250,\n      interpolate = interpolateZoom,\n      gestures = [],\n      listeners = dispatch(\"start\", \"zoom\", \"end\"),\n      touchstarting,\n      touchending,\n      touchDelay = 500,\n      wheelDelay = 150,\n      clickDistance2 = 0;\n\n  function zoom(selection) {\n    selection\n        .property(\"__zoom\", defaultTransform)\n        .on(\"wheel.zoom\", wheeled)\n        .on(\"mousedown.zoom\", mousedowned)\n        .on(\"dblclick.zoom\", dblclicked)\n      .filter(touchable)\n        .on(\"touchstart.zoom\", touchstarted)\n        .on(\"touchmove.zoom\", touchmoved)\n        .on(\"touchend.zoom touchcancel.zoom\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  zoom.transform = function(collection, transform) {\n    var selection = collection.selection ? collection.selection() : collection;\n    selection.property(\"__zoom\", defaultTransform);\n    if (collection !== selection) {\n      schedule(collection, transform);\n    } else {\n      selection.interrupt().each(function() {\n        gesture(this, arguments)\n            .start()\n            .zoom(null, typeof transform === \"function\" ? transform.apply(this, arguments) : transform)\n            .end();\n      });\n    }\n  };\n\n  zoom.scaleBy = function(selection, k) {\n    zoom.scaleTo(selection, function() {\n      var k0 = this.__zoom.k,\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return k0 * k1;\n    });\n  };\n\n  zoom.scaleTo = function(selection, k) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t0 = this.__zoom,\n          p0 = centroid(e),\n          p1 = t0.invert(p0),\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);\n    });\n  };\n\n  zoom.translateBy = function(selection, x, y) {\n    zoom.transform(selection, function() {\n      return constrain(this.__zoom.translate(\n        typeof x === \"function\" ? x.apply(this, arguments) : x,\n        typeof y === \"function\" ? y.apply(this, arguments) : y\n      ), extent.apply(this, arguments), translateExtent);\n    });\n  };\n\n  zoom.translateTo = function(selection, x, y) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t = this.__zoom,\n          p = centroid(e);\n      return constrain(identity.translate(p[0], p[1]).scale(t.k).translate(\n        typeof x === \"function\" ? -x.apply(this, arguments) : -x,\n        typeof y === \"function\" ? -y.apply(this, arguments) : -y\n      ), e, translateExtent);\n    });\n  };\n\n  function scale(transform, k) {\n    k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));\n    return k === transform.k ? transform : new Transform(k, transform.x, transform.y);\n  }\n\n  function translate(transform, p0, p1) {\n    var x = p0[0] - p1[0] * transform.k, y = p0[1] - p1[1] * transform.k;\n    return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);\n  }\n\n  function centroid(extent) {\n    return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];\n  }\n\n  function schedule(transition, transform, center) {\n    transition\n        .on(\"start.zoom\", function() { gesture(this, arguments).start(); })\n        .on(\"interrupt.zoom end.zoom\", function() { gesture(this, arguments).end(); })\n        .tween(\"zoom\", function() {\n          var that = this,\n              args = arguments,\n              g = gesture(that, args),\n              e = extent.apply(that, args),\n              p = center || centroid(e),\n              w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),\n              a = that.__zoom,\n              b = typeof transform === \"function\" ? transform.apply(that, args) : transform,\n              i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));\n          return function(t) {\n            if (t === 1) t = b; // Avoid rounding error on end.\n            else { var l = i(t), k = w / l[2]; t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k); }\n            g.zoom(null, t);\n          };\n        });\n  }\n\n  function gesture(that, args) {\n    for (var i = 0, n = gestures.length, g; i < n; ++i) {\n      if ((g = gestures[i]).that === that) {\n        return g;\n      }\n    }\n    return new Gesture(that, args);\n  }\n\n  function Gesture(that, args) {\n    this.that = that;\n    this.args = args;\n    this.index = -1;\n    this.active = 0;\n    this.extent = extent.apply(that, args);\n  }\n\n  Gesture.prototype = {\n    start: function() {\n      if (++this.active === 1) {\n        this.index = gestures.push(this) - 1;\n        this.emit(\"start\");\n      }\n      return this;\n    },\n    zoom: function(key, transform) {\n      if (this.mouse && key !== \"mouse\") this.mouse[1] = transform.invert(this.mouse[0]);\n      if (this.touch0 && key !== \"touch\") this.touch0[1] = transform.invert(this.touch0[0]);\n      if (this.touch1 && key !== \"touch\") this.touch1[1] = transform.invert(this.touch1[0]);\n      this.that.__zoom = transform;\n      this.emit(\"zoom\");\n      return this;\n    },\n    end: function() {\n      if (--this.active === 0) {\n        gestures.splice(this.index, 1);\n        this.index = -1;\n        this.emit(\"end\");\n      }\n      return this;\n    },\n    emit: function(type) {\n      customEvent(new ZoomEvent(zoom, type, this.that.__zoom), listeners.apply, listeners, [type, this.that, this.args]);\n    }\n  };\n\n  function wheeled() {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, arguments),\n        t = this.__zoom,\n        k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),\n        p = mouse(this);\n\n    // If the mouse is in the same location as before, reuse it.\n    // If there were recent wheel events, reset the wheel idle timeout.\n    if (g.wheel) {\n      if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {\n        g.mouse[1] = t.invert(g.mouse[0] = p);\n      }\n      clearTimeout(g.wheel);\n    }\n\n    // If this wheel event won’t trigger a transform change, ignore it.\n    else if (t.k === k) return;\n\n    // Otherwise, capture the mouse point and location at the start.\n    else {\n      g.mouse = [p, t.invert(p)];\n      interrupt(this);\n      g.start();\n    }\n\n    noevent();\n    g.wheel = setTimeout(wheelidled, wheelDelay);\n    g.zoom(\"mouse\", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));\n\n    function wheelidled() {\n      g.wheel = null;\n      g.end();\n    }\n  }\n\n  function mousedowned() {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var g = gesture(this, arguments),\n        v = select(event.view).on(\"mousemove.zoom\", mousemoved, true).on(\"mouseup.zoom\", mouseupped, true),\n        p = mouse(this),\n        x0 = event.clientX,\n        y0 = event.clientY;\n\n    dragDisable(event.view);\n    nopropagation();\n    g.mouse = [p, this.__zoom.invert(p)];\n    interrupt(this);\n    g.start();\n\n    function mousemoved() {\n      noevent();\n      if (!g.moved) {\n        var dx = event.clientX - x0, dy = event.clientY - y0;\n        g.moved = dx * dx + dy * dy > clickDistance2;\n      }\n      g.zoom(\"mouse\", constrain(translate(g.that.__zoom, g.mouse[0] = mouse(g.that), g.mouse[1]), g.extent, translateExtent));\n    }\n\n    function mouseupped() {\n      v.on(\"mousemove.zoom mouseup.zoom\", null);\n      dragEnable(event.view, g.moved);\n      noevent();\n      g.end();\n    }\n  }\n\n  function dblclicked() {\n    if (!filter.apply(this, arguments)) return;\n    var t0 = this.__zoom,\n        p0 = mouse(this),\n        p1 = t0.invert(p0),\n        k1 = t0.k * (event.shiftKey ? 0.5 : 2),\n        t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, arguments), translateExtent);\n\n    noevent();\n    if (duration > 0) select(this).transition().duration(duration).call(schedule, t1, p0);\n    else select(this).call(zoom.transform, t1);\n  }\n\n  function touchstarted() {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, arguments),\n        touches = event.changedTouches,\n        started,\n        n = touches.length, i, t, p;\n\n    nopropagation();\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = touch(this, touches, t.identifier);\n      p = [p, this.__zoom.invert(p), t.identifier];\n      if (!g.touch0) g.touch0 = p, started = true;\n      else if (!g.touch1) g.touch1 = p;\n    }\n\n    // If this is a dbltap, reroute to the (optional) dblclick.zoom handler.\n    if (touchstarting) {\n      touchstarting = clearTimeout(touchstarting);\n      if (!g.touch1) {\n        g.end();\n        p = select(this).on(\"dblclick.zoom\");\n        if (p) p.apply(this, arguments);\n        return;\n      }\n    }\n\n    if (started) {\n      touchstarting = setTimeout(function() { touchstarting = null; }, touchDelay);\n      interrupt(this);\n      g.start();\n    }\n  }\n\n  function touchmoved() {\n    var g = gesture(this, arguments),\n        touches = event.changedTouches,\n        n = touches.length, i, t, p, l;\n\n    noevent();\n    if (touchstarting) touchstarting = clearTimeout(touchstarting);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = touch(this, touches, t.identifier);\n      if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;\n      else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;\n    }\n    t = g.that.__zoom;\n    if (g.touch1) {\n      var p0 = g.touch0[0], l0 = g.touch0[1],\n          p1 = g.touch1[0], l1 = g.touch1[1],\n          dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,\n          dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;\n      t = scale(t, Math.sqrt(dp / dl));\n      p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];\n      l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];\n    }\n    else if (g.touch0) p = g.touch0[0], l = g.touch0[1];\n    else return;\n    g.zoom(\"touch\", constrain(translate(t, p, l), g.extent, translateExtent));\n  }\n\n  function touchended() {\n    var g = gesture(this, arguments),\n        touches = event.changedTouches,\n        n = touches.length, i, t;\n\n    nopropagation();\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, touchDelay);\n    for (i = 0; i < n; ++i) {\n      t = touches[i];\n      if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;\n      else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;\n    }\n    if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;\n    if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);\n    else g.end();\n  }\n\n  zoom.wheelDelta = function(_) {\n    return arguments.length ? (wheelDelta = typeof _ === \"function\" ? _ : constant(+_), zoom) : wheelDelta;\n  };\n\n  zoom.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), zoom) : filter;\n  };\n\n  zoom.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), zoom) : touchable;\n  };\n\n  zoom.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;\n  };\n\n  zoom.scaleExtent = function(_) {\n    return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];\n  };\n\n  zoom.translateExtent = function(_) {\n    return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];\n  };\n\n  zoom.constrain = function(_) {\n    return arguments.length ? (constrain = _, zoom) : constrain;\n  };\n\n  zoom.duration = function(_) {\n    return arguments.length ? (duration = +_, zoom) : duration;\n  };\n\n  zoom.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, zoom) : interpolate;\n  };\n\n  zoom.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? zoom : value;\n  };\n\n  zoom.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);\n  };\n\n  return zoom;\n}\n"]},"metadata":{},"sourceType":"module"}